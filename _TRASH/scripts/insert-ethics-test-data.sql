-- Script para inserir dados de teste completos no módulo de ética
-- Execute este script após o database estar configurado

-- Inserir casos de ética de exemplo
INSERT INTO ethics_reports (
    tenant_id,
    protocol_number,
    title,
    description,
    category,
    severity,
    priority,
    status,
    is_anonymous,
    reporter_name,
    reporter_email,
    reporter_phone,
    incident_date,
    incident_location,
    people_involved,
    evidence_description,
    potential_legal_implications,
    estimated_financial_impact,
    regulatory_requirements,
    created_at,
    updated_at,
    last_activity_at,
    assigned_to,
    due_date,
    sla_breach,
    investigation_summary,
    resolution,
    legal_privilege,
    requires_regulatory_notification,
    regulatory_agencies,
    public_disclosure_risk,
    risk_score,
    auto_classification_reason
) VALUES 
(
    '46b1c048-85a1-423b-96fc-776007c8de1f',
    'ETH-2025-001',
    'Possível Conflito de Interesse na Contratação',
    'Denúncia sobre favorecimento de fornecedor específico em processo licitatório, envolvendo possível relacionamento pessoal entre gestor e representante da empresa.',
    'conflict_of_interest',
    'high',
    'high',
    'investigating',
    false,
    'Maria Silva Santos',
    'maria.santos@empresa.com',
    '+5511999887766',
    '2025-01-15',
    'Sede - Departamento de Compras',
    'João Carlos (Gestor de Compras), Fornecedor XYZ Ltda',
    'E-mails trocados entre as partes, documentos do processo licitatório, registros de reuniões',
    'Possível violação da Lei de Licitações (8.666/93), responsabilidade civil e administrativa',
    15000.00,
    'Lei 8.666/93, Código de Ética Empresarial',
    '2025-01-16 09:00:00',
    '2025-01-20 14:30:00',
    '2025-01-20 14:30:00',
    (SELECT id FROM profiles WHERE tenant_id = '46b1c048-85a1-423b-96fc-776007c8de1f' LIMIT 1),
    '2025-02-15',
    false,
    'Investigação em andamento. Coletadas evidências preliminares. Entrevistas agendadas.',
    null,
    false,
    true,
    '["SEC", "CVM"]',
    'medium',
    75,
    'Alto risco devido a valor financeiro e possível violação regulatória'
),
(
    '46b1c048-85a1-423b-96fc-776007c8de1f',
    'ETH-2025-002',
    'Assédio Moral no Ambiente de Trabalho',
    'Relatos de comportamento abusivo e intimidação sistemática por parte de supervisor, afetando equipe de trabalho.',
    'harassment',
    'critical',
    'critical',
    'investigating',
    true,
    null,
    null,
    null,
    '2025-01-10',
    'Filial Norte - 3º Andar',
    'Supervisor não identificado, 3 funcionários da equipe de vendas',
    'Testemunhos de colegas, registros de reuniões, histórico de licenças médicas',
    'Possível responsabilização trabalhista, danos morais, processos judiciais',
    25000.00,
    'CLT, NR-17, Política Interna de RH',
    '2025-01-18 16:45:00',
    '2025-01-21 10:15:00',
    '2025-01-21 10:15:00',
    (SELECT id FROM profiles WHERE tenant_id = '46b1c048-85a1-423b-96fc-776007c8de1f' LIMIT 1),
    '2025-02-01',
    false,
    'Caso crítico em investigação. Medidas cautelares implementadas.',
    null,
    true,
    false,
    '[]',
    'low',
    90,
    'Risco crítico devido à natureza do assédio e impacto nos funcionários'
),
(
    '46b1c048-85a1-423b-96fc-776007c8de1f',
    'ETH-2025-003',
    'Fraude em Reembolso de Despesas',
    'Suspeita de manipulação de recibos e duplicação de solicitações de reembolso por funcionário do setor financeiro.',
    'fraud',
    'medium',
    'high',
    'resolved',
    false,
    'Carlos Eduardo Lima',
    'carlos.lima@empresa.com',
    '+5511888776655',
    '2025-01-05',
    'Sede - Departamento Financeiro',
    'Funcionário do setor financeiro (nome protegido)',
    'Recibos alterados, duplicatas de solicitações, extratos bancários',
    'Crime contra o patrimônio, possível demissão por justa causa',
    8500.00,
    'Código Penal, CLT, Políticas Internas',
    '2025-01-08 11:20:00',
    '2025-01-25 16:00:00',
    '2025-01-25 16:00:00',
    (SELECT id FROM profiles WHERE tenant_id = '46b1c048-85a1-423b-96fc-776007c8de1f' LIMIT 1),
    '2025-01-30',
    false,
    'Investigação concluída. Evidências coletadas e analisadas.',
    'Funcionário foi demitido por justa causa. Processo de ressarcimento iniciado. Melhorias nos controles internos implementadas.',
    false,
    false,
    '[]',
    'low',
    65,
    'Risco médio - fraude interna com valor moderado'
);

-- Inserir planos de investigação
INSERT INTO investigation_plans (
    tenant_id,
    ethics_report_id,
    investigation_type,
    investigation_scope,
    investigation_objectives,
    estimated_duration_days,
    planned_start_date,
    planned_completion_date,
    assigned_investigator_id,
    budget_allocated,
    methodology,
    evidence_preservation_plan,
    interview_plan,
    timeline_milestones,
    status,
    progress_percentage,
    created_at,
    updated_at
) VALUES 
(
    '46b1c048-85a1-423b-96fc-776007c8de1f',
    (SELECT id FROM ethics_reports WHERE protocol_number = 'ETH-2025-001' AND tenant_id = '46b1c048-85a1-423b-96fc-776007c8de1f'),
    'full',
    'Investigação completa sobre possível conflito de interesse na contratação do Fornecedor XYZ',
    'Determinar se houve violação das políticas de conflito de interesse; Identificar responsabilidades; Propor medidas corretivas',
    45,
    '2025-01-20',
    '2025-03-05',
    (SELECT id FROM profiles WHERE tenant_id = '46b1c048-85a1-423b-96fc-776007c8de1f' LIMIT 1),
    15000.00,
    'Análise documental, entrevistas estruturadas, análise de sistemas',
    'Preservação de e-mails, documentos licitatórios, registros de sistema',
    'João Carlos (gestor), Fornecedor XYZ (representante), testemunhas do processo',
    '{"semana_1": "Coleta documental", "semana_2": "Entrevistas", "semana_3": "Análise", "semana_4": "Relatório"}',
    'active',
    35,
    '2025-01-20 09:00:00',
    '2025-01-23 14:30:00'
),
(
    '46b1c048-85a1-423b-96fc-776007c8de1f',
    (SELECT id FROM ethics_reports WHERE protocol_number = 'ETH-2025-002' AND tenant_id = '46b1c048-85a1-423b-96fc-776007c8de1f'),
    'external',
    'Investigação externa sobre denúncia de assédio moral',
    'Investigação imparcial e especializada sobre alegações de assédio; Proteção da vítima; Recomendações de ação',
    30,
    '2025-01-25',
    '2025-02-25',
    null,
    25000.00,
    'Investigação externa com especialista em assédio, entrevistas confidenciais',
    'Testemunhos gravados, documentos de RH, histórico médico (se autorizado)',
    'Vítimas (anônimas), testemunhas, supervisor investigado',
    '{"fase_1": "Contratação externa", "fase_2": "Entrevistas", "fase_3": "Análise", "fase_4": "Relatório"}',
    'active',
    20,
    '2025-01-22 10:00:00',
    '2025-01-25 16:15:00'
);

-- Inserir evidências
INSERT INTO evidence_items (
    tenant_id,
    ethics_report_id,
    investigation_plan_id,
    evidence_type,
    title,
    description,
    file_path,
    file_hash,
    collected_by,
    collected_date,
    chain_of_custody,
    legal_hold,
    privilege_claimed,
    evidence_category,
    authenticity_verified,
    integrity_status,
    access_restrictions,
    retention_until,
    created_at
) VALUES 
(
    '46b1c048-85a1-423b-96fc-776007c8de1f',
    (SELECT id FROM ethics_reports WHERE protocol_number = 'ETH-2025-001' AND tenant_id = '46b1c048-85a1-423b-96fc-776007c8de1f'),
    (SELECT id FROM investigation_plans WHERE investigation_type = 'full' LIMIT 1),
    'digital',
    'E-mails entre Gestor e Fornecedor',
    'Correspondências eletrônicas trocadas entre João Carlos e representante do Fornecedor XYZ no período de 2024-2025',
    '/evidence/eth-2025-001/emails-001.eml',
    'sha256:a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456',
    (SELECT id FROM profiles WHERE tenant_id = '46b1c048-85a1-423b-96fc-776007c8de1f' LIMIT 1),
    '2025-01-21',
    '[{"date": "2025-01-21", "custodian": "Investigador Principal", "action": "Coleta inicial"}]',
    true,
    false,
    'communication',
    true,
    'intact',
    'investigation_team_only',
    '2027-01-21',
    '2025-01-21 10:30:00'
),
(
    '46b1c048-85a1-423b-96fc-776007c8de1f',
    (SELECT id FROM ethics_reports WHERE protocol_number = 'ETH-2025-002' AND tenant_id = '46b1c048-85a1-423b-96fc-776007c8de1f'),
    (SELECT id FROM investigation_plans WHERE investigation_type = 'external' LIMIT 1),
    'testimony',
    'Depoimento de Testemunha 1',
    'Relato confidencial de funcionário que presenciou comportamentos inadequados',
    '/evidence/eth-2025-002/testimony-001.mp3',
    'sha256:b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef1234567',
    (SELECT id FROM profiles WHERE tenant_id = '46b1c048-85a1-423b-96fc-776007c8de1f' LIMIT 1),
    '2025-01-26',
    '[{"date": "2025-01-26", "custodian": "Investigador Externo", "action": "Coleta de testemunho"}]',
    true,
    true,
    'witness_statement',
    true,
    'intact',
    'legal_team_only',
    '2027-01-26',
    '2025-01-26 14:20:00'
);

-- Inserir ações corretivas
INSERT INTO corrective_actions (
    tenant_id,
    ethics_report_id,
    action_type,
    title,
    description,
    responsible_party_id,
    target_completion_date,
    actual_completion_date,
    status,
    effectiveness_measurement,
    verification_method,
    progress_percentage,
    budget_allocated,
    budget_spent,
    follow_up_required,
    follow_up_date,
    lessons_learned,
    created_at,
    updated_at
) VALUES 
(
    '46b1c048-85a1-423b-96fc-776007c8de1f',
    (SELECT id FROM ethics_reports WHERE protocol_number = 'ETH-2025-001' AND tenant_id = '46b1c048-85a1-423b-96fc-776007c8de1f'),
    'policy_update',
    'Revisão da Política de Conflito de Interesses',
    'Atualização da política existente com critérios mais rigorosos para identificação e gerenciamento de conflitos',
    (SELECT id FROM profiles WHERE tenant_id = '46b1c048-85a1-423b-96fc-776007c8de1f' LIMIT 1),
    '2025-03-01',
    null,
    'in_progress',
    'Taxa de identificação de conflitos aumentou 30%',
    'Auditoria interna, questionários de avaliação',
    60,
    5000.00,
    3200.00,
    true,
    '2025-04-01',
    null,
    '2025-01-22 09:00:00',
    '2025-01-25 11:30:00'
),
(
    '46b1c048-85a1-423b-96fc-776007c8de1f',
    (SELECT id FROM ethics_reports WHERE protocol_number = 'ETH-2025-002' AND tenant_id = '46b1c048-85a1-423b-96fc-776007c8de1f'),
    'training',
    'Treinamento Anti-Assédio para Liderança',
    'Programa obrigatório de capacitação em prevenção e gestão de casos de assédio moral para todos os gestores',
    (SELECT id FROM profiles WHERE tenant_id = '46b1c048-85a1-423b-96fc-776007c8de1f' LIMIT 1),
    '2025-02-28',
    null,
    'planned',
    'Redução de 50% em denúncias similares',
    'Avaliação pós-treinamento, pesquisa de clima',
    10,
    8000.00,
    800.00,
    true,
    '2025-05-28',
    null,
    '2025-01-23 08:30:00',
    '2025-01-26 16:45:00'
),
(
    '46b1c048-85a1-423b-96fc-776007c8de1f',
    (SELECT id FROM ethics_reports WHERE protocol_number = 'ETH-2025-003' AND tenant_id = '46b1c048-85a1-423b-96fc-776007c8de1f'),
    'process_improvement',
    'Melhoria no Sistema de Reembolsos',
    'Implementação de controles automáticos para detectar duplicatas e validação digital de recibos',
    (SELECT id FROM profiles WHERE tenant_id = '46b1c048-85a1-423b-96fc-776007c8de1f' LIMIT 1),
    '2025-02-15',
    '2025-02-10',
    'completed',
    'Zero casos de fraude similares detectados',
    'Auditoria do sistema, testes de penetração',
    100,
    12000.00,
    11500.00,
    false,
    null,
    'Sistema automatizado eficaz na prevenção de fraudes similares',
    '2025-01-10 10:00:00',
    '2025-02-10 17:20:00'
);

-- Inserir notificações regulamentares
INSERT INTO regulatory_notifications (
    tenant_id,
    ethics_report_id,
    agency,
    notification_type,
    title,
    required_by_date,
    submitted_date,
    status,
    submission_method,
    confirmation_number,
    agency_contact,
    public_disclosure_required,
    public_disclosure_date,
    follow_up_required,
    follow_up_date,
    legal_counsel_involved,
    risk_assessment,
    created_at,
    updated_at
) VALUES 
(
    '46b1c048-85a1-423b-96fc-776007c8de1f',
    (SELECT id FROM ethics_reports WHERE protocol_number = 'ETH-2025-001' AND tenant_id = '46b1c048-85a1-423b-96fc-776007c8de1f'),
    'SEC',
    'regulatory_breach',
    'Notificação de Possível Violação em Processo Licitatório',
    '2025-02-20',
    null,
    'pending',
    'electronic_filing',
    null,
    'sec-compliance@sec.gov.br',
    false,
    null,
    true,
    '2025-03-01',
    true,
    'medium',
    '2025-01-22 14:00:00',
    '2025-01-25 09:30:00'
),
(
    '46b1c048-85a1-423b-96fc-776007c8de1f',
    (SELECT id FROM ethics_reports WHERE protocol_number = 'ETH-2025-002' AND tenant_id = '46b1c048-85a1-423b-96fc-776007c8de1f'),
    'OSHA',
    'workplace_safety',
    'Relato de Ambiente de Trabalho Hostil',
    '2025-02-05',
    '2025-01-28',
    'submitted',
    'online_portal',
    'OSHA-2025-001234',
    'workplace-safety@osha.gov',
    false,
    null,
    true,
    '2025-03-15',
    false,
    'low',
    '2025-01-25 11:45:00',
    '2025-01-28 15:20:00'
);