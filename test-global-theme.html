<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🌐 Teste de Tema Global - GRC Controller</title>
    <style>
        body {
            font-family: 'Inter', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #10b981 0%, #06b6d4 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #10b981 0%, #06b6d4 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        .section {
            padding: 30px;
            border-bottom: 1px solid #e0e0e0;
        }
        .section:last-child { border-bottom: none; }
        .card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 24px;
            margin: 15px 0;
        }
        .success { border-left: 5px solid #10b981; background: #ecfdf5; }
        .info { border-left: 5px solid #06b6d4; background: #f0f9ff; }
        .warning { border-left: 5px solid #f59e0b; background: #fffbeb; }
        .btn {
            background: #10b981;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            margin: 8px;
            font-weight: 600;
            transition: all 0.2s;
        }
        .btn:hover { 
            background: #059669; 
            transform: translateY(-2px);
        }
        .color-preview {
            display: inline-block;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            margin: 0 10px;
            border: 2px solid #e5e7eb;
            vertical-align: middle;
        }
        .green-theme { background: hsl(173, 88%, 58%); }
        .default-theme { background: hsl(233, 79%, 47%); }
        .code {
            background: #1f2937;
            color: #f9fafb;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Monaco', monospace;
            font-size: 13px;
            overflow-x: auto;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🌐 Teste de Tema Global</h1>
            <p>Verificação da aplicação automática do tema "ui_nativa"</p>
        </div>

        <div class="section">
            <h2>📊 Informações do Tema Global</h2>
            <div class="card info">
                <h3>🎨 Tema "ui_nativa" Ativo</h3>
                <p><strong>Banco de dados configurado:</strong></p>
                <ul>
                    <li><strong>Nome:</strong> ui_nativa</li>
                    <li><strong>Display Name:</strong> UI Nativa</li>
                    <li><strong>Status:</strong> is_active = true</li>
                    <li><strong>Cor Primária:</strong> <span class="color-preview green-theme"></span> 173 88% 58% (Verde brilhante)</li>
                    <li><strong>Cor Secundária:</strong> 335 78% 58%</li>
                    <li><strong>Background:</strong> 225 39% 5%</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>🔍 Sistema de Prioridades</h2>
            <div class="card">
                <h3>Ordem de Aplicação:</h3>
                <ol>
                    <li><strong>🥇 Preferências do Usuário</strong> (localStorage)</li>
                    <li><strong>🥈 Tema Global Ativo</strong> (banco de dados)</li>
                    <li><strong>🥉 Cores Padrão</strong> (CSS/script)</li>
                </ol>
                
                <div class="card warning">
                    <h4>⚠️ Teste Atual</h4>
                    <p>localStorage está vazio, então o sistema deveria aplicar o tema global "ui_nativa" com cor verde.</p>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>🧪 Teste da Aplicação</h2>
            <div class="card">
                <h3>Procedimento:</h3>
                <ol>
                    <li>Limpar localStorage (garantir ausência de preferências)</li>
                    <li>Abrir aplicação principal</li>
                    <li>Observar logs no console</li>
                    <li>Verificar se cor verde é aplicada</li>
                </ol>
                
                <div style="text-align: center; margin: 20px 0;">
                    <button class="btn" onclick="clearAndTest()">🧹 Limpar e Testar</button>
                    <button class="btn" onclick="openApp()">🚀 Abrir Aplicação</button>
                    <button class="btn" onclick="showExpectedLogs()">📋 Logs Esperados</button>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>📋 Logs Esperados</h2>
            <div class="card" id="expected-logs" style="display: none;">
                <div class="code">
🎨 [2ms] 🔍 CHECKING-STORAGE: localStorage: null
🎨 [3ms] 🎯 INITIAL-COLORS: cores padrão carregadas
🎨 [4ms] 🌐 NO-USER-PREFS: ThemeContext aplicará tema global
🎨 [5ms] ✅ STYLE-APPLIED: CSS inicial aplicado
🎨 ThemeContext: Nenhuma preferência encontrada - mantendo cores do sistema
🌐 ThemeContext: Buscando tema global ativo...
🎨 ThemeContext: Aplicando tema global: ui_nativa
🎨 ThemeContext: Tema global aplicado com sucesso {
  theme: "ui_nativa",
  primary: "173 88% 58%",
  secondary: "335 78% 58%"
}
                </div>
                <p><strong>✅ Resultado esperado:</strong> Aplicação carrega com cor verde do tema "ui_nativa"</p>
            </div>
        </div>

        <div class="section">
            <h2>🎯 Comparação Visual</h2>
            <div class="card">
                <h3>Cores de Referência:</h3>
                <div style="display: flex; align-items: center; gap: 20px; margin: 20px 0;">
                    <div>
                        <span class="color-preview default-theme"></span>
                        <strong>Padrão:</strong> 233 79% 47% (Azul)
                    </div>
                    <div>
                        <span class="color-preview green-theme"></span>
                        <strong>ui_nativa:</strong> 173 88% 58% (Verde)
                    </div>
                </div>
                <p><strong>A aplicação deve carregar na cor VERDE, não azul!</strong></p>
            </div>
        </div>
    </div>

    <script>
        function clearAndTest() {
            localStorage.clear();
            alert('✅ localStorage limpo!\n\nAgora abra a aplicação e observe:\n- Console deve mostrar busca por tema global\n- Cor verde deve ser aplicada automaticamente');
        }

        function openApp() {
            window.open('http://localhost:8080', '_blank');
        }

        function showExpectedLogs() {
            const logsDiv = document.getElementById('expected-logs');
            logsDiv.style.display = logsDiv.style.display === 'none' ? 'block' : 'none';
        }

        // Verificar estado atual
        document.addEventListener('DOMContentLoaded', () => {
            const hasPrefs = localStorage.getItem('grc-theme-preferences');
            if (hasPrefs) {
                const warning = document.createElement('div');
                warning.className = 'card warning';
                warning.innerHTML = `
                    <h4>⚠️ Atenção</h4>
                    <p>localStorage contém preferências de usuário. Para testar o tema global, clique em "Limpar e Testar".</p>
                `;
                document.querySelector('.section').appendChild(warning);
            }
        });
    </script>
</body>
</html>