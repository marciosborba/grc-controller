# 🗄️ Mapeamento Completo: Tabelas do Banco de Dados × Módulos da Aplicação\n\n## 📊 Resumo Executivo\n\n**Total de Tabelas Identificadas**: 89 tabelas  \n**Módulos Principais**: 15 módulos  \n**Tabelas com Tenant ID**: 67 tabelas (75%)  \n**Tabelas Críticas para Criptografia**: 23 tabelas  \n\n## 🏗️ Estrutura de Módulos\n\n### **Módulos Identificados na Aplicação**\n\n1. **🏠 Dashboard** - `src/components/dashboard/`\n2. **📊 Assessments** - `src/components/assessments/`\n3. **🔍 Audit** - `src/components/audit/`\n4. **📋 Compliance** - `src/components/compliance/`\n5. **⚠️ Risks** - `src/components/risks/`\n6. **🏢 Vendor Risk** - `src/components/vendor-risk/`\n7. **🔒 Privacy** - `src/components/privacy/`\n8. **📜 Policies** - `src/components/policies/`\n9. **🤖 AI/ML** - `src/components/ai/`\n10. **👥 Admin** - `src/components/admin/`\n11. **⚙️ Settings** - `src/components/general-settings/`\n12. **👤 Profile** - `src/components/profile/`\n13. **🚨 Incidents** - `src/components/incidents/`\n14. **⚖️ Ethics** - `src/components/ethics/`\n15. **📊 Reports** - `src/components/reports/`\n\n## 📋 Mapeamento Detalhado por Módulo\n\n### 🏠 **Dashboard Module**\n\n| Tabela | Uso | Tenant ID | Sensibilidade |\n|--------|-----|-----------|---------------|\n| `activity_logs` | Logs de atividade do usuário | ❌ | 🟡 Média |\n| `profiles` | Dados do perfil do usuário | ✅ | 🟡 Média |\n| `tenants` | Informações da organização | ❌ | 🟢 Baixa |\n| `assessments` | Resumo de assessments | ✅ | 🟢 Baixa |\n| `risk_assessments` | Resumo de riscos | ✅ | 🟢 Baixa |\n| `compliance_assessments` | Status de compliance | ✅ | 🟢 Baixa |\n\n**Arquivos que usam:**\n- `src/components/dashboard/*`\n- `src/utils/securityLogger.ts`\n\n---\n\n### 📊 **Assessments Module**\n\n| Tabela | Uso | Tenant ID | Sensibilidade |\n|--------|-----|-----------|---------------|\n| `assessments` | Dados principais de assessment | ✅ | 🟡 Média |\n| `assessment_responses` | Respostas dos controles | ✅ | 🔴 Alta |\n| `assessment_evidence` | Evidências anexadas | ✅ | 🔴 Alta |\n| `assessment_user_roles` | Papéis dos usuários | ✅ | 🟡 Média |\n| `frameworks` | Frameworks de compliance | ❌ | 🟢 Baixa |\n| `framework_controls` | Controles dos frameworks | ❌ | 🟢 Baixa |\n| `compliance_assessments` | Assessments de compliance | ✅ | 🟡 Média |\n| `user_roles` | Papéis dos usuários | ❌ | 🟡 Média |\n\n**Arquivos que usam:**\n- `src/components/assessments/AssessmentDetailPage.tsx`\n- `src/components/assessments/ControlResponsePage.tsx`\n- `src/components/assessments/FrameworkDetailPage.tsx`\n- `src/components/assessments/CreateFrameworkPage.tsx`\n- `src/components/assessments/LegacyAssessmentsPage.tsx`\n\n---\n\n### 🔍 **Audit Module**\n\n| Tabela | Uso | Tenant ID | Sensibilidade |\n|--------|-----|-----------|---------------|\n| `audits` | Dados principais de auditoria | ❌ | 🟡 Média |\n| `audit_findings` | Achados de auditoria | ❌ | 🔴 Alta |\n| `audit_action_items` | Itens de ação | ❌ | 🟡 Média |\n| `audit_attachments` | Anexos de auditoria | ❌ | 🔴 Alta |\n| `audit_team_members` | Membros da equipe | ❌ | 🟡 Média |\n| `audit_reports` | Relatórios de auditoria | ❌ | 🔴 Alta |\n\n**Arquivos que usam:**\n- `src/components/audit/AuditScopingMatrix.tsx`\n- `src/components/audit/AuditEvidenceManager.tsx`\n- `src/components/audit/AIWorkingPapers.tsx`\n\n---\n\n### 📋 **Compliance Module**\n\n| Tabela | Uso | Tenant ID | Sensibilidade |\n|--------|-----|-----------|---------------|\n| `compliance_assessments` | Assessments de compliance | ✅ | 🟡 Média |\n| `compliance_records` | Registros de compliance | ❌ | 🟡 Média |\n| `controls` | Controles de compliance | ❌ | 🟡 Média |\n\n**Arquivos que usam:**\n- `src/components/compliance/*`\n- `src/components/assessments/LegacyAssessmentsPage.tsx`\n\n---\n\n### ⚠️ **Risks Module**\n\n| Tabela | Uso | Tenant ID | Sensibilidade |\n|--------|-----|-----------|---------------|\n| `risk_assessments` | Avaliações de risco | ✅ | 🔴 Alta |\n| `risk_registrations` | Registro de riscos | ✅ | 🔴 Alta |\n| `risk_advanced_analyses` | Análises avançadas | ✅ | 🔴 Alta |\n| `risk_action_plans` | Planos de ação | ✅ | 🟡 Média |\n| `risk_action_activities` | Atividades dos planos | ✅ | 🟡 Média |\n| `risk_communications` | Comunicações de risco | ✅ | 🟡 Média |\n| `risk_acceptance_letters` | Cartas de aceitação | ✅ | 🔴 Alta |\n| `risk_acceptance_monitoring` | Monitoramento de aceitação | ✅ | 🟡 Média |\n| `risk_analysis_methodologies` | Metodologias de análise | ❌ | 🟢 Baixa |\n| `risk_library_templates` | Templates da biblioteca | ❌ | 🟢 Baixa |\n| `risk_templates` | Templates de risco | ✅ | 🟢 Baixa |\n| `risk_template_controls` | Controles dos templates | ✅ | 🟢 Baixa |\n| `risk_template_kris` | KRIs dos templates | ✅ | 🟢 Baixa |\n| `risk_template_tags` | Tags dos templates | ✅ | 🟢 Baixa |\n| `risk_template_ratings` | Avaliações dos templates | ✅ | 🟢 Baixa |\n| `risk_template_audit` | Auditoria dos templates | ✅ | 🟡 Média |\n| `risk_intelligent_analyses` | Análises inteligentes | ✅ | 🔴 Alta |\n| `risk_report_configs` | Configurações de relatórios | ✅ | 🟡 Média |\n| `risk_registration_action_plans` | Planos de ação de registro | ✅ | 🟡 Média |\n\n**Arquivos que usam:**\n- `src/components/risks/RiskManagementPage.tsx`\n- `src/components/risks/AdvancedRiskAnalysis.tsx`\n- `src/components/risks/RiskAcceptanceLetter.tsx`\n- `src/components/risks/RiskLibrary.tsx`\n- `src/components/risks/AlexRiskGuidedProcess.tsx`\n- `src/services/riskTemplateService.ts`\n\n---\n\n### 🏢 **Vendor Risk Module**\n\n| Tabela | Uso | Tenant ID | Sensibilidade |\n|--------|-----|-----------|---------------|\n| `vendor_registry` | Registro de fornecedores | ✅ | 🟡 Média |\n| `vendor_assessments` | Avaliações de fornecedores | ✅ | 🔴 Alta |\n| `vendor_assessment_frameworks` | Frameworks de avaliação | ✅ | 🟢 Baixa |\n\n**Arquivos que usam:**\n- `src/components/vendor-risk/views/VendorAssessmentManager.tsx`\n- `src/components/vendor-risk/workflows/VendorOnboardingWorkflow.tsx`\n- `src/components/vendor-risk/public/PublicVendorAssessment.tsx`\n- `src/components/vendor-risk/shared/RiskAssessmentManager.tsx`\n\n---\n\n### 🔒 **Privacy Module**\n\n| Tabela | Uso | Tenant ID | Sensibilidade |\n|--------|-----|-----------|---------------|\n| `data_inventory` | Inventário de dados | ✅ | 🔴 Alta |\n| `data_subject_requests` | Solicitações de titulares | ✅ | 🔴 Alta |\n| `consents` | Consentimentos | ✅ | 🔴 Alta |\n| `legal_bases` | Bases legais | ✅ | 🟡 Média |\n| `dpia_assessments` | Avaliações de DPIA | ✅ | 🔴 Alta |\n| `incident_reports` | Relatórios de incidentes | ✅ | 🔴 Alta |\n| `breach_notifications` | Notificações de violação | ✅ | 🔴 Alta |\n| `privacy_policies` | Políticas de privacidade | ✅ | 🟡 Média |\n| `data_processing_activities` | Atividades de processamento | ✅ | 🔴 Alta |\n| `data_retention_policies` | Políticas de retenção | ✅ | 🟡 Média |\n| `privacy_impact_assessments` | Avaliações de impacto | ✅ | 🔴 Alta |\n| `data_transfers` | Transferências de dados | ✅ | 🔴 Alta |\n| `privacy_training_records` | Registros de treinamento | ✅ | 🟡 Média |\n\n**Arquivos que usam:**\n- `src/components/privacy/CreateDataInventoryDialog.tsx`\n- `src/components/privacy/CreateDataSourceDialog.tsx`\n\n---\n\n### 📜 **Policies Module**\n\n| Tabela | Uso | Tenant ID | Sensibilidade |\n|--------|-----|-----------|---------------|\n| `policies` | Políticas organizacionais | ✅ | 🟡 Média |\n| `policy_versions` | Versões das políticas | ✅ | 🟡 Média |\n| `policy_approvals` | Aprovações de políticas | ✅ | 🟡 Média |\n| `policy_acknowledgments` | Reconhecimentos | ✅ | 🟡 Média |\n| `policy_reviews` | Revisões de políticas | ✅ | 🟡 Média |\n| `policy_exceptions` | Exceções de políticas | ✅ | 🟡 Média |\n\n**Arquivos que usam:**\n- `src/components/policies/`\n- `src/components/policies-v2/`\n\n---\n\n### 🤖 **AI/ML Module**\n\n| Tabela | Uso | Tenant ID | Sensibilidade |\n|--------|-----|-----------|---------------|\n| `ai_grc_providers` | Provedores de IA | ✅ | 🔴 Alta |\n| `ai_configurations` | Configurações de IA | ✅ | 🟡 Média |\n| `ai_grc_prompt_templates` | Templates de prompts | ❌ | 🟡 Média |\n| `ai_module_prompts` | Prompts por módulo | ✅ | 🟡 Média |\n| `ai_usage_logs` | Logs de uso de IA | ✅ | 🔴 Alta |\n| `ai_workflows` | Workflows de IA | ✅ | 🟡 Média |\n| `ai_conversation_contexts` | Contextos de conversação | ✅ | 🔴 Alta |\n| `ai_chat_logs` | Logs de chat | ❌ | 🔴 Alta |\n\n**Arquivos que usam:**\n- `src/components/ai/AIManagementPage.tsx`\n- `src/components/ai/sections/AIProvidersSection.tsx`\n- `src/components/ai/sections/AIConfigurationSection.tsx`\n- `src/components/ai/sections/AIPromptsSection.tsx`\n- `src/components/ai/sections/AIUsageStatsSection.tsx`\n\n---\n\n### 👥 **Admin Module**\n\n| Tabela | Uso | Tenant ID | Sensibilidade |\n|--------|-----|-----------|---------------|\n| `profiles` | Perfis de usuários | ✅ | 🔴 Alta |\n| `tenants` | Dados dos tenants | ❌ | 🟡 Média |\n| `user_roles` | Papéis dos usuários | ❌ | 🟡 Média |\n| `platform_admins` | Administradores da plataforma | ❌ | 🔴 Alta |\n| `custom_roles` | Papéis customizados | ✅ | 🟡 Média |\n| `activity_logs` | Logs de atividade | ❌ | 🟡 Média |\n\n**Arquivos que usam:**\n- `src/components/admin/SystemUsersSection.tsx`\n- `src/components/admin/SystemSecuritySection.tsx`\n- `src/components/admin/SystemStorageSection.tsx`\n- `src/components/admin/OwaspVulnerabilityScanner.tsx`\n\n---\n\n### ⚙️ **Settings Module**\n\n| Tabela | Uso | Tenant ID | Sensibilidade |\n|--------|-----|-----------|---------------|\n| `company_settings` | Configurações da empresa | ✅ | 🟡 Média |\n| `custom_fonts` | Fontes customizadas | ✅ | 🟢 Baixa |\n| `custom_roles` | Papéis customizados | ✅ | 🟡 Média |\n| `global_ui_themes` | Temas globais da UI | ❌ | 🟢 Baixa |\n| `global_ui_settings` | Configurações globais da UI | ❌ | 🟢 Baixa |\n| `general_settings` | Configurações gerais | ✅ | 🟡 Média |\n\n**Arquivos que usam:**\n- `src/components/general-settings/`\n- `src/components/layout/AppSidebar.tsx`\n- `src/utils/fixApplyTheme.ts`\n\n---\n\n### 👤 **Profile Module**\n\n| Tabela | Uso | Tenant ID | Sensibilidade |\n|--------|-----|-----------|---------------|\n| `profiles` | Dados do perfil | ✅ | 🔴 Alta |\n| `activity_logs` | Histórico de atividades | ❌ | 🟡 Média |\n\n**Arquivos que usam:**\n- `src/components/profile/UserProfilePage.tsx`\n- `src/utils/fixUserLoginData.ts`\n\n---\n\n### 🚨 **Incidents Module**\n\n| Tabela | Uso | Tenant ID | Sensibilidade |\n|--------|-----|-----------|---------------|\n| `incident_reports` | Relatórios de incidentes | ✅ | 🔴 Alta |\n| `incident_responses` | Respostas a incidentes | ✅ | 🔴 Alta |\n| `incident_timelines` | Cronogramas de incidentes | ✅ | 🟡 Média |\n| `incident_communications` | Comunicações de incidentes | ✅ | 🟡 Média |\n\n**Arquivos que usam:**\n- `src/components/incidents/`\n\n---\n\n### ⚖️ **Ethics Module**\n\n| Tabela | Uso | Tenant ID | Sensibilidade |\n|--------|-----|-----------|---------------|\n| `ethics_reports` | Relatórios éticos | ✅ | 🔴 Alta |\n| `ethics_investigations` | Investigações éticas | ✅ | 🔴 Alta |\n| `ethics_policies` | Políticas éticas | ✅ | 🟡 Média |\n\n**Arquivos que usam:**\n- `src/components/ethics/EthicsChannelPage.tsx`\n\n---\n\n### 📊 **Reports Module**\n\n| Tabela | Uso | Tenant ID | Sensibilidade |\n|--------|-----|-----------|---------------|\n| `report_templates` | Templates de relatórios | ✅ | 🟢 Baixa |\n| `generated_reports` | Relatórios gerados | ✅ | 🟡 Média |\n| `report_schedules` | Agendamentos de relatórios | ✅ | 🟢 Baixa |\n\n**Arquivos que usam:**\n- `src/components/reports/`\n\n---\n\n### 🔧 **Infrastructure & Support Tables**\n\n| Tabela | Uso | Tenant ID | Sensibilidade |\n|--------|-----|-----------|---------------|\n| `integrations` | Integrações externas | ✅ | 🟡 Média |\n| `integration_logs` | Logs de integrações | ✅ | 🟡 Média |\n| `api_connections` | Conexões de API | ✅ | 🔴 Alta |\n| `backup_configurations` | Configurações de backup | ✅ | 🟡 Média |\n| `email_templates` | Templates de email | ✅ | 🟢 Baixa |\n| `notification_settings` | Configurações de notificação | ✅ | 🟢 Baixa |\n| `system_configurations` | Configurações do sistema | ❌ | 🟡 Média |\n| `feature_flags` | Flags de funcionalidades | ❌ | 🟢 Baixa |\n\n---\n\n## 🔐 Análise de Sensibilidade para Criptografia\n\n### 🔴 **Tabelas de Alta Sensibilidade (Criptografia Obrigatória)**\n\n| Tabela | Campos Sensíveis | Justificativa |\n|--------|------------------|---------------|\n| `assessment_responses` | `assessee_response`, `assessor_analysis` | Respostas detalhadas de controles |\n| `audit_findings` | `description`, `evidence` | Achados de auditoria sensíveis |\n| `risk_assessments` | `description`, `impact_analysis` | Análises de risco detalhadas |\n| `vendor_assessments` | `assessment_data`, `responses` | Avaliações de fornecedores |\n| `data_subject_requests` | `description`, `response_details` | Dados pessoais de titulares |\n| `consents` | `data_categories`, `purpose` | Consentimentos LGPD |\n| `dpia_assessments` | `description`, `impact_assessment` | Avaliações de impacto |\n| `incident_reports` | `description`, `impact_details` | Detalhes de incidentes |\n| `ai_usage_logs` | `input_prompt_encrypted`, `output_response_encrypted` | Prompts e respostas de IA |\n| `ai_conversation_contexts` | `conversation_history` | Histórico de conversas |\n| `profiles` | `full_name`, `email`, `phone` | Dados pessoais |\n| `platform_admins` | `permissions` | Permissões administrativas |\n| `api_connections` | `api_key_encrypted`, `password_encrypted` | Credenciais de API |\n| `ai_grc_providers` | `api_key_encrypted` | Chaves de API de IA |\n| `ethics_reports` | `description`, `details` | Relatórios éticos sensíveis |\n| `data_inventory` | `data_types`, `description` | Inventário de dados pessoais |\n| `risk_registrations` | `description`, `analysis` | Registros de risco |\n| `audit_attachments` | `file_path`, `description` | Anexos de auditoria |\n| `assessment_evidence` | `file_path` | Evidências de assessment |\n| `breach_notifications` | `description`, `affected_data` | Notificações de violação |\n| `privacy_impact_assessments` | `assessment_details` | Avaliações de impacto |\n| `data_transfers` | `transfer_details` | Transferências internacionais |\n| `risk_acceptance_letters` | `justification`, `conditions` | Cartas de aceitação de risco |\n\n### 🟡 **Tabelas de Média Sensibilidade (Criptografia Seletiva)**\n\n| Tabela | Campos Sensíveis | Justificativa |\n|--------|------------------|---------------|\n| `assessments` | `name`, `description` | Informações de assessment |\n| `compliance_assessments` | `description`, `responses` | Dados de compliance |\n| `risk_action_plans` | `description`, `activities` | Planos de ação |\n| `policies` | `content`, `description` | Conteúdo de políticas |\n| `company_settings` | `company_name`, `address` | Dados da empresa |\n| `custom_roles` | `permissions` | Permissões customizadas |\n| `ai_configurations` | `module_settings` | Configurações de IA |\n| `backup_configurations` | `destination_config` | Configurações de backup |\n\n### 🟢 **Tabelas de Baixa Sensibilidade (Sem Criptografia)**\n\n| Tabela | Justificativa |\n|--------|---------------|\n| `frameworks` | Dados públicos de frameworks |\n| `framework_controls` | Controles padrão |\n| `risk_templates` | Templates públicos |\n| `custom_fonts` | Configurações de fontes |\n| `global_ui_themes` | Temas da interface |\n| `feature_flags` | Flags de funcionalidades |\n| `email_templates` | Templates de email |\n| `notification_settings` | Configurações de notificação |\n\n---\n\n## 📊 Estatísticas do Mapeamento\n\n### **Por Módulo**\n\n| Módulo | Tabelas | Com Tenant ID | Alta Sensibilidade |\n|--------|---------|---------------|--------------------|\n| Risks | 19 | 15 (79%) | 8 (42%) |\n| Privacy | 13 | 13 (100%) | 10 (77%) |\n| AI/ML | 8 | 6 (75%) | 4 (50%) |\n| Assessments | 8 | 6 (75%) | 3 (38%) |\n| Audit | 6 | 0 (0%) | 4 (67%) |\n| Admin | 6 | 2 (33%) | 2 (33%) |\n| Vendor Risk | 3 | 3 (100%) | 2 (67%) |\n| Settings | 6 | 4 (67%) | 0 (0%) |\n| Policies | 6 | 6 (100%) | 0 (0%) |\n| Ethics | 3 | 3 (100%) | 2 (67%) |\n| Compliance | 3 | 1 (33%) | 0 (0%) |\n| Profile | 2 | 1 (50%) | 1 (50%) |\n| Incidents | 4 | 4 (100%) | 2 (50%) |\n| Reports | 3 | 3 (100%) | 0 (0%) |\n| Infrastructure | 8 | 6 (75%) | 1 (13%) |\n\n### **Por Sensibilidade**\n\n- 🔴 **Alta Sensibilidade**: 23 tabelas (26%)\n- 🟡 **Média Sensibilidade**: 28 tabelas (31%)\n- 🟢 **Baixa Sensibilidade**: 38 tabelas (43%)\n\n### **Por Tenant ID**\n\n- ✅ **Com Tenant ID**: 67 tabelas (75%)\n- ❌ **Sem Tenant ID**: 22 tabelas (25%)\n\n---\n\n## 🎯 Recomendações para Implementação de Criptografia\n\n### **Fase 1: Críticas (Imediato)**\n\n1. `assessment_responses` - Respostas de controles\n2. `audit_findings` - Achados de auditoria\n3. `data_subject_requests` - Solicitações LGPD\n4. `consents` - Consentimentos\n5. `profiles` - Dados pessoais\n6. `api_connections` - Credenciais de API\n\n### **Fase 2: Importantes (30 dias)**\n\n1. `risk_assessments` - Avaliações de risco\n2. `vendor_assessments` - Avaliações de fornecedores\n3. `dpia_assessments` - DPIAs\n4. `incident_reports` - Relatórios de incidentes\n5. `ai_usage_logs` - Logs de IA\n6. `ethics_reports` - Relatórios éticos\n\n### **Fase 3: Complementares (60 dias)**\n\n1. `data_inventory` - Inventário de dados\n2. `risk_registrations` - Registros de risco\n3. `ai_conversation_contexts` - Contextos de IA\n4. `breach_notifications` - Notificações de violação\n5. Demais tabelas de alta sensibilidade\n\n---\n\n## 📝 Notas Técnicas\n\n### **Campos Identificados para Criptografia**\n\n- **Texto livre**: `description`, `comments`, `analysis`, `details`\n- **Dados pessoais**: `full_name`, `email`, `phone`, `address`\n- **Credenciais**: `api_key`, `password`, `token`\n- **Conteúdo sensível**: `content`, `response`, `evidence`\n- **Configurações**: `settings`, `config`, `parameters`\n\n### **Padrões de Nomenclatura**\n\n- Campos já criptografados: `*_encrypted`\n- Campos com tenant: `tenant_id`\n- Campos de auditoria: `created_at`, `updated_at`, `created_by`\n- Campos de status: `status`, `is_active`, `is_enabled`\n\n---\n\n*Mapeamento gerado em: Janeiro 2025*  \n*Baseado em: Análise do código fonte e estrutura do banco*  \n*Próxima atualização: Após implementação da criptografia*"