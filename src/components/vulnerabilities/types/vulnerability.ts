// =====================================================
// VULNERABILITY MANAGEMENT TYPES
// =====================================================

export type VulnerabilitySeverity = 'Critical' | 'High' | 'Medium' | 'Low' | 'Info';
export type VulnerabilityStatus = 'Open' | 'In_Progress' | 'Testing' | 'Resolved' | 'Accepted' | 'False_Positive' | 'Duplicate';
export type VulnerabilitySource = 'Pentest' | 'SAST' | 'DAST' | 'Cloud' | 'Infrastructure' | 'Manual' | 'Risk_Register' | 'Bug_Bounty' | 'Compliance_Audit';
export type RemediationEffort = 'Low' | 'Medium' | 'High' | 'Very_High';
export type BusinessImpact = 'Low' | 'Medium' | 'High' | 'Critical';
export type AssetType = 'Web_Application' | 'Mobile_App' | 'API' | 'Database' | 'Server' | 'Network_Device' | 'Cloud_Service' | 'Desktop_App';

export interface Vulnerability {
  id: string;
  tenant_id: string;
  title: string;
  description: string;
  severity: VulnerabilitySeverity;
  cvss_score?: number;
  cvss_vector?: string;
  cve_id?: string;
  cwe_id?: string;
  source_type: VulnerabilitySource;
  source_tool: string;
  source_scan_id?: string;
  asset_name: string;
  asset_type: AssetType;
  asset_ip?: string;
  asset_url?: string;
  status: VulnerabilityStatus;
  assigned_to?: string;
  assigned_team?: string;
  due_date?: Date;
  sla_breach?: boolean;
  created_at: Date;
  updated_at: Date;
  resolved_at?: Date;
  remediation_effort: RemediationEffort;
  business_impact: BusinessImpact;
  risk_score: number;
  priority_score: number;
  tags: string[];
  evidence?: VulnerabilityEvidence[];
  remediation_steps?: string;
  remediation_notes?: string;
  false_positive_reason?: string;
  retest_required: boolean;
  exploit_available: boolean;
  patch_available: boolean;
  workaround_available: boolean;
  compliance_frameworks?: string[];
  created_by: string;
  updated_by: string;
}

export interface VulnerabilityEvidence {
  id: string;
  type: 'Screenshot' | 'Code_Snippet' | 'Log' | 'Document' | 'URL';
  title: string;
  content: string;
  file_path?: string;
  created_at: Date;
}

export interface VulnerabilityMetrics {
  total_vulnerabilities: number;
  by_severity: Record<VulnerabilitySeverity, number>;
  by_status: Record<VulnerabilityStatus, number>;
  by_source: Record<VulnerabilitySource, number>;
  sla_compliance: number;
  avg_resolution_time: number;
  overdue_count: number;
  critical_open: number;
  high_open: number;
  trend_data: {
    date: string;
    total: number;
    resolved: number;
    new: number;
  }[];
}

export interface VulnerabilityFilter {
  severity?: VulnerabilitySeverity[];
  status?: VulnerabilityStatus[];
  source_type?: VulnerabilitySource[];
  asset_type?: AssetType[];
  assigned_to?: string[];
  tags?: string[];
  date_range?: {
    start: Date;
    end: Date;
  };
  cvss_range?: {
    min: number;
    max: number;
  };
  search?: string;
  sla_breach?: boolean;
  overdue?: boolean;
}